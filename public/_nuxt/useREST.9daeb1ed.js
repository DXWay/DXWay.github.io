import{a as l,j as u,k as i}from"./entry.d4b1644f.js";const g=()=>{async function v(e,s){var o=l("jwt"),n=l("login"),r=l("role"),t=l("business_id");try{const a=await $fetch("http://127.0.0.1:3003/user/login",{method:"post",body:{login:e,password:s}});o.value=a.jwt,n.value=a.login,r.value=a.role,t.value=a.business_id,u().prepare(a.jwt);var w=await u().connect();w=="SOCKET_CONNECTED"&&i("/dashboard")}catch{throw await u().disconnect(),o.value=null,n.value=null,r.value=null,t.value=null,new Error("UNAUTHORIZED_ACCESS")}}async function c(){console.log("useREST - logout");var e=l("jwt"),s=l("login"),o=l("role"),n=l("business_id");await u().disconnect(),e.value=null,e.value=null,s.value=null,o.value=null,n.value=null,i("/")}return{login:v,logout:c}};export{g as u};
